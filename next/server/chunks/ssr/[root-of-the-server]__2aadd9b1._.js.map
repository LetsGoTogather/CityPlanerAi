{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 271, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/genkit.ts"],"sourcesContent":["import {genkit} from 'genkit';\nimport {googleAI} from '@genkit-ai/google-genai';\n\nexport const ai = genkit({\n  plugins: [googleAI()],\n  model: 'googleai/gemini-1.5-flash',\n});\n"],"names":[],"mappings":";;;AAAA;AAAA;AACA;AAAA;;;AAEO,MAAM,KAAK,CAAA,GAAA,uIAAA,CAAA,SAAM,AAAD,EAAE;IACvB,SAAS;QAAC,CAAA,GAAA,6KAAA,CAAA,WAAQ,AAAD;KAAI;IACrB,OAAO;AACT","debugId":null}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/schemas.ts"],"sourcesContent":["import { z } from 'genkit';\n\n// Schemas for generate-city-plan.ts\nconst CoordinateSchema = z.array(z.number()).length(2);\n\nconst RoadSchema = z.object({\n  type: z.enum(['highway', 'arterial', 'local']),\n  coordinates: z.array(CoordinateSchema),\n  reason: z.string(),\n});\n\nconst ZoneSchema = z.object({\n  type: z.enum(['residential', 'commercial', 'industrial', 'greenSpaces', 'publicServices']),\n  coordinates: z.array(CoordinateSchema),\n  density: z.string().optional(),\n  reason: z.string(),\n});\n\nconst InfrastructureSchema = z.object({\n  type: z.string(), // e.g., 'power_plant', 'hospital', 'school'\n  coordinates: CoordinateSchema,\n  reason: z.string(),\n  capacity: z.string().optional(),\n});\n\nexport const MapDataSchema = z.object({\n  roads: z.array(RoadSchema),\n  zones: z.array(ZoneSchema),\n  infrastructure: z.array(InfrastructureSchema),\n});\n\nconst CityPlanReportSchema = z.object({\n  overview: z.string().optional(), // Made optional to simplify AI response\n  roadNetwork: z.object({\n    highways: z.array(z.string()),\n    arterialRoads: z.array(z.string()),\n    localRoads: z.array(z.string()),\n    reasoning: z.string(),\n  }).optional(),\n  zoning: z.string().describe(\"A JSON string representing the zoning details.\").optional(),\n  infrastructure: z.object({\n    powerSupply: z.object({ locations: z.array(z.string()), type: z.string(), capacity: z.string(), reasoning: z.string() }),\n    waterSupply: z.object({ treatmentPlants: z.array(z.string()), pipelineNetwork: z.string(), reasoning: z.string() }),\n    sewageSystem: z.object({ treatmentPlants: z.array(z.string()), network: z.string(), reasoning: z.string() }),\n  }).optional(),\n  budgetBreakdown: z.object({\n    landAcquisition: z.string(),\n    roadConstruction: z.string(),\n    buildingConstruction: z.string(),\n    utilities: z.string(),\n    materials: z.string().describe(\"A JSON string detailing required materials and quantities.\"),\n  }),\n  timeline: z.object({\n    phase1: z.string(),\n    phase2: z.string(),\n    phase3: z.string(),\n  }),\n});\n\nexport const GenerateCityPlanOutputSchema = z.object({\n  mapData: MapDataSchema,\n  report: CityPlanReportSchema,\n});\nexport type GenerateCityPlanOutput = z.infer<typeof GenerateCityPlanOutputSchema>;\n\nexport const GenerateCityPlanInputSchema = z.object({\n    terrainAnalysis: z.string(),\n    population: z.number(),\n    budget: z.number(),\n    zoneDistribution: z.string(),\n    specialRequirements: z.string(),\n});\nexport type GenerateCityPlanInput = z.infer<typeof GenerateCityPlanInputSchema>;\n\n\n// Schemas for optimize-zone-distribution.ts\nexport const OptimizeZoneDistributionInputSchema = z.object({\n  terrainAnalysis: z\n    .string()\n    .describe('The analysis of the terrain, soil, water bodies, and topography from the satellite image.'),\n  population: z.number().describe('The target population of the city.'),\n  budget: z.number().describe('The budget for the city in local currency.'),\n});\nexport type OptimizeZoneDistributionInput = z.infer<typeof OptimizeZoneDistributionInputSchema>;\n\nexport const OptimizeZoneDistributionOutputSchema = z.object({\n  zoneDistribution: z.object({\n    residential: z.number().describe('The percentage of land allocated to residential areas.'),\n    commercial: z.number().describe('The percentage of land allocated to commercial areas.'),\n    industrial: z.number().describe('The percentage of land allocated to industrial areas.'),\n    greenSpaces: z.number().describe('The percentage of land allocated to green spaces.'),\n    publicServices: z.number().describe('The percentage of land allocated to public services.'),\n  }).describe('The optimized zone distribution for the city.'),\n  reasoning: z.string().describe('The detailed reasoning behind the suggested zone distribution.'),\n});\nexport type OptimizeZoneDistributionOutput = z.infer<typeof OptimizeZoneDistributionOutputSchema>;\n\n\n// Schemas for simulate-traffic-and-pollution.ts\nexport const SimulateTrafficAndPollutionInputSchema = z.object({\n  cityPlan: z.string().describe('The city plan as a JSON string.'),\n});\nexport type SimulateTrafficAndPollutionInput = z.infer<typeof SimulateTrafficAndPollutionInputSchema>;\n\nexport const SimulateTrafficAndPollutionOutputSchema = z.object({\n  trafficAnalysis: z.string().describe('An analysis of the traffic flow in the city, identifying potential congestion points.'),\n  pollutionAnalysis: z.string().describe('An analysis of the pollution impact of the city, identifying potential problem areas.'),\n  potentialIssues: z.array(z.string()).describe('A list of potential issues identified by the simulation.'),\n  suggestions: z.array(z.string()).describe('A list of suggestions to address the potential issues.'),\n});\nexport type SimulateTrafficAndPollutionOutput = z.infer<typeof SimulateTrafficAndPollutionOutputSchema>;\n\n\n// Schemas for summarize-terrain-analysis.ts\nexport const SummarizeTerrainAnalysisInputSchema = z.object({\n  satelliteImageDataUri: z\n    .string()\n    .describe(\n      \"A satellite image of the land, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'.\"\n    ),\n  terrainAnalysis: z\n    .string()\n    .describe('The raw terrain analysis to be summarized.'),\n});\nexport type SummarizeTerrainAnalysisInput = z.infer<typeof SummarizeTerrainAnalysisInputSchema>;\n\nexport const SummarizeTerrainAnalysisOutputSchema = z.object({\n  summary: z.string().describe('A concise summary of the terrain analysis.'),\n});\nexport type SummarizeTerrainAnalysisOutput = z.infer<typeof SummarizeTerrainAnalysisOutputSchema>;\n"],"names":[],"mappings":";;;;;;;;;;;AAAA;AAAA;;AAEA,oCAAoC;AACpC,MAAM,mBAAmB,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM,IAAI,MAAM,CAAC;AAEpD,MAAM,aAAa,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC1B,MAAM,uIAAA,CAAA,IAAC,CAAC,IAAI,CAAC;QAAC;QAAW;QAAY;KAAQ;IAC7C,aAAa,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC;IACrB,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM;AAClB;AAEA,MAAM,aAAa,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC1B,MAAM,uIAAA,CAAA,IAAC,CAAC,IAAI,CAAC;QAAC;QAAe;QAAc;QAAc;QAAe;KAAiB;IACzF,aAAa,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC;IACrB,SAAS,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ;IAC5B,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM;AAClB;AAEA,MAAM,uBAAuB,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACpC,MAAM,uIAAA,CAAA,IAAC,CAAC,MAAM;IACd,aAAa;IACb,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM;IAChB,UAAU,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ;AAC/B;AAEO,MAAM,gBAAgB,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACpC,OAAO,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC;IACf,OAAO,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC;IACf,gBAAgB,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC;AAC1B;AAEA,MAAM,uBAAuB,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACpC,UAAU,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ;IAC7B,aAAa,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;QACpB,UAAU,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM;QAC1B,eAAe,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM;QAC/B,YAAY,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM;QAC5B,WAAW,uIAAA,CAAA,IAAC,CAAC,MAAM;IACrB,GAAG,QAAQ;IACX,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC,kDAAkD,QAAQ;IACtF,gBAAgB,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;QACvB,aAAa,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YAAE,WAAW,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM;YAAK,MAAM,uIAAA,CAAA,IAAC,CAAC,MAAM;YAAI,UAAU,uIAAA,CAAA,IAAC,CAAC,MAAM;YAAI,WAAW,uIAAA,CAAA,IAAC,CAAC,MAAM;QAAG;QACtH,aAAa,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YAAE,iBAAiB,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM;YAAK,iBAAiB,uIAAA,CAAA,IAAC,CAAC,MAAM;YAAI,WAAW,uIAAA,CAAA,IAAC,CAAC,MAAM;QAAG;QACjH,cAAc,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;YAAE,iBAAiB,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM;YAAK,SAAS,uIAAA,CAAA,IAAC,CAAC,MAAM;YAAI,WAAW,uIAAA,CAAA,IAAC,CAAC,MAAM;QAAG;IAC5G,GAAG,QAAQ;IACX,iBAAiB,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;QACxB,iBAAiB,uIAAA,CAAA,IAAC,CAAC,MAAM;QACzB,kBAAkB,uIAAA,CAAA,IAAC,CAAC,MAAM;QAC1B,sBAAsB,uIAAA,CAAA,IAAC,CAAC,MAAM;QAC9B,WAAW,uIAAA,CAAA,IAAC,CAAC,MAAM;QACnB,WAAW,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACjC;IACA,UAAU,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;QACjB,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM;QAChB,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM;QAChB,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM;IAClB;AACF;AAEO,MAAM,+BAA+B,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACnD,SAAS;IACT,QAAQ;AACV;AAGO,MAAM,8BAA8B,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAChD,iBAAiB,uIAAA,CAAA,IAAC,CAAC,MAAM;IACzB,YAAY,uIAAA,CAAA,IAAC,CAAC,MAAM;IACpB,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM;IAChB,kBAAkB,uIAAA,CAAA,IAAC,CAAC,MAAM;IAC1B,qBAAqB,uIAAA,CAAA,IAAC,CAAC,MAAM;AACjC;AAKO,MAAM,sCAAsC,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC1D,iBAAiB,uIAAA,CAAA,IAAC,CACf,MAAM,GACN,QAAQ,CAAC;IACZ,YAAY,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IAChC,QAAQ,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC9B;AAGO,MAAM,uCAAuC,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC3D,kBAAkB,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;QACzB,aAAa,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;QACjC,YAAY,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;QAChC,YAAY,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;QAChC,aAAa,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;QACjC,gBAAgB,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACtC,GAAG,QAAQ,CAAC;IACZ,WAAW,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AACjC;AAKO,MAAM,yCAAyC,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC7D,UAAU,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAChC;AAGO,MAAM,0CAA0C,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC9D,iBAAiB,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACrC,mBAAmB,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;IACvC,iBAAiB,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM,IAAI,QAAQ,CAAC;IAC9C,aAAa,uIAAA,CAAA,IAAC,CAAC,KAAK,CAAC,uIAAA,CAAA,IAAC,CAAC,MAAM,IAAI,QAAQ,CAAC;AAC5C;AAKO,MAAM,sCAAsC,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC1D,uBAAuB,uIAAA,CAAA,IAAC,CACrB,MAAM,GACN,QAAQ,CACP;IAEJ,iBAAiB,uIAAA,CAAA,IAAC,CACf,MAAM,GACN,QAAQ,CAAC;AACd;AAGO,MAAM,uCAAuC,uIAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IAC3D,SAAS,uIAAA,CAAA,IAAC,CAAC,MAAM,GAAG,QAAQ,CAAC;AAC/B","debugId":null}},
    {"offset": {"line": 428, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/summarize-terrain-analysis.ts"],"sourcesContent":["'use server';\n\n/**\n * @fileOverview Summarizes terrain analysis from a satellite image.\n *\n * - summarizeTerrainAnalysis - A function that summarizes terrain analysis.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {SummarizeTerrainAnalysisInputSchema, SummarizeTerrainAnalysisOutputSchema, type SummarizeTerrainAnalysisInput, type SummarizeTerrainAnalysisOutput} from '@/ai/schemas';\n\nexport async function summarizeTerrainAnalysis(\n  input: SummarizeTerrainAnalysisInput\n): Promise<SummarizeTerrainAnalysisOutput> {\n  return summarizeTerrainAnalysisFlow(input);\n}\n\nconst summarizeTerrainAnalysisPrompt = ai.definePrompt({\n  name: 'summarizeTerrainAnalysisPrompt',\n  input: {schema: SummarizeTerrainAnalysisInputSchema},\n  output: {schema: SummarizeTerrainAnalysisOutputSchema},\n  prompt: `You are an expert in summarizing terrain analysis reports for urban planners.\n\n  Summarize the following terrain analysis, highlighting key features relevant to city planning.\n\n  Terrain Analysis:\n  {{terrainAnalysis}}\n\n  Satellite Image:\n  {{media url=satelliteImageDataUri}}\n  `,\n});\n\nconst summarizeTerrainAnalysisFlow = ai.defineFlow(\n  {\n    name: 'summarizeTerrainAnalysisFlow',\n    inputSchema: SummarizeTerrainAnalysisInputSchema,\n    outputSchema: SummarizeTerrainAnalysisOutputSchema,\n  },\n  async input => {\n    const {output} = await summarizeTerrainAnalysisPrompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;AAEA;;;;CAIC,GAED;AACA;;;;;;AAEO,eAAe,yBACpB,KAAoC;IAEpC,OAAO,6BAA6B;AACtC;AAEA,MAAM,iCAAiC,mHAAA,CAAA,KAAE,CAAC,YAAY,CAAC;IACrD,MAAM;IACN,OAAO;QAAC,QAAQ,oHAAA,CAAA,sCAAmC;IAAA;IACnD,QAAQ;QAAC,QAAQ,oHAAA,CAAA,uCAAoC;IAAA;IACrD,QAAQ,CAAC;;;;;;;;;EAST,CAAC;AACH;AAEA,MAAM,+BAA+B,mHAAA,CAAA,KAAE,CAAC,UAAU,CAChD;IACE,MAAM;IACN,aAAa,oHAAA,CAAA,sCAAmC;IAChD,cAAc,oHAAA,CAAA,uCAAoC;AACpD,GACA,OAAM;IACJ,MAAM,EAAC,MAAM,EAAC,GAAG,MAAM,+BAA+B;IACtD,OAAO;AACT;;;IA/BoB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 485, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/optimize-zone-distribution.ts"],"sourcesContent":["'use server';\n\n/**\n * @fileOverview Optimizes the zone distribution for a city plan based on terrain analysis,\n *               population, and budget constraints.\n *\n * - optimizeZoneDistribution - A function that takes terrain analysis, population, and budget\n *                              as input and suggests an optimized zone distribution.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {OptimizeZoneDistributionInputSchema, OptimizeZoneDistributionOutputSchema, type OptimizeZoneDistributionInput, type OptimizeZoneDistributionOutput} from '@/ai/schemas';\n\nexport async function optimizeZoneDistribution(input: OptimizeZoneDistributionInput): Promise<OptimizeZoneDistributionOutput> {\n  return optimizeZoneDistributionFlow(input);\n}\n\nconst prompt = ai.definePrompt({\n  name: 'optimizeZoneDistributionPrompt',\n  input: {schema: OptimizeZoneDistributionInputSchema},\n  output: {schema: OptimizeZoneDistributionOutputSchema},\n  prompt: `You are an expert urban planner with 20 years of experience.\n\nBased on the terrain analysis, population, and budget provided, suggest an optimized zone distribution for the city.\n\nTerrain Analysis: {{{terrainAnalysis}}}\nPopulation: {{{population}}}\nBudget: {{{budget}}}\n\nConsider the following factors when determining the zone distribution:\n\n*   The need for residential areas to house the population.\n*   The need for commercial areas to provide jobs and services.\n*   The need for industrial areas to support the economy.\n*   The need for green spaces to provide recreation and improve the environment.\n*   The need for public services such as schools, hospitals, and police stations.\n\nReturn the zone distribution as a JSON object with the following keys:\n\n*   residential: The percentage of land allocated to residential areas.\n*   commercial: The percentage of land allocated to commercial areas.\n*   industrial: The percentage of land allocated to industrial areas.\n*   greenSpaces: The percentage of land allocated to green spaces.\n*   publicServices: The percentage of land allocated to public services.\n\nAlso, include a detailed reasoning behind the suggested zone distribution.\n\nOutput format:{\n  \"zoneDistribution\": {\n    \"residential\": 40,\n    \"commercial\": 20,\n    \"industrial\": 15,\n    \"greenSpaces\": 15,\n    \"publicServices\": 10\n  },\n  \"reasoning\": \"Detailed reasoning here...\"\n}`,\n});\n\nconst optimizeZoneDistributionFlow = ai.defineFlow(\n  {\n    name: 'optimizeZoneDistributionFlow',\n    inputSchema: OptimizeZoneDistributionInputSchema,\n    outputSchema: OptimizeZoneDistributionOutputSchema,\n  },\n  async input => {\n    const {output} = await prompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;AAEA;;;;;;CAMC,GAED;AACA;;;;;;AAEO,eAAe,yBAAyB,KAAoC;IACjF,OAAO,6BAA6B;AACtC;AAEA,MAAM,SAAS,mHAAA,CAAA,KAAE,CAAC,YAAY,CAAC;IAC7B,MAAM;IACN,OAAO;QAAC,QAAQ,oHAAA,CAAA,sCAAmC;IAAA;IACnD,QAAQ;QAAC,QAAQ,oHAAA,CAAA,uCAAoC;IAAA;IACrD,QAAQ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAmCV,CAAC;AACF;AAEA,MAAM,+BAA+B,mHAAA,CAAA,KAAE,CAAC,UAAU,CAChD;IACE,MAAM;IACN,aAAa,oHAAA,CAAA,sCAAmC;IAChD,cAAc,oHAAA,CAAA,uCAAoC;AACpD,GACA,OAAM;IACJ,MAAM,EAAC,MAAM,EAAC,GAAG,MAAM,OAAO;IAC9B,OAAO;AACT;;;IAvDoB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 570, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/simulate-traffic-and-pollution.ts"],"sourcesContent":["'use server';\n/**\n * @fileOverview Simulates traffic and pollution for a city plan.\n *\n * - simulateTrafficAndPollution - A function that simulates traffic and pollution based on a city plan.\n */\n\nimport {ai} from '@/ai/genkit';\nimport {SimulateTrafficAndPollutionInputSchema, SimulateTrafficAndPollutionOutputSchema, type SimulateTrafficAndPollutionInput, type SimulateTrafficAndPollutionOutput} from '@/ai/schemas';\n\n\nexport async function simulateTrafficAndPollution(input: SimulateTrafficAndPollutionInput): Promise<SimulateTrafficAndPollutionOutput> {\n  return simulateTrafficAndPollutionFlow(input);\n}\n\nconst simulateTrafficAndPollutionPrompt = ai.definePrompt({\n  name: 'simulateTrafficAndPollutionPrompt',\n  input: {schema: SimulateTrafficAndPollutionInputSchema},\n  output: {schema: SimulateTrafficAndPollutionOutputSchema},\n  prompt: `You are an expert urban planner specializing in simulating the traffic flow and pollution impact of city plans.\n\nYou will receive a city plan as a JSON string.  Your task is to analyze the plan and identify potential issues related to traffic and pollution.\n\nBased on your analysis, provide a list of potential issues and suggestions to address them.\n\nCity Plan:\n{{{cityPlan}}}\n\nReturn your response in JSON format.\n`,\n});\n\nconst simulateTrafficAndPollutionFlow = ai.defineFlow(\n  {\n    name: 'simulateTrafficAndPollutionFlow',\n    inputSchema: SimulateTrafficAndPollutionInputSchema,\n    outputSchema: SimulateTrafficAndPollutionOutputSchema,\n  },\n  async input => {\n    const {output} = await simulateTrafficAndPollutionPrompt(input);\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;AACA;;;;CAIC,GAED;AACA;;;;;;AAGO,eAAe,4BAA4B,KAAuC;IACvF,OAAO,gCAAgC;AACzC;AAEA,MAAM,oCAAoC,mHAAA,CAAA,KAAE,CAAC,YAAY,CAAC;IACxD,MAAM;IACN,OAAO;QAAC,QAAQ,oHAAA,CAAA,yCAAsC;IAAA;IACtD,QAAQ;QAAC,QAAQ,oHAAA,CAAA,0CAAuC;IAAA;IACxD,QAAQ,CAAC;;;;;;;;;;AAUX,CAAC;AACD;AAEA,MAAM,kCAAkC,mHAAA,CAAA,KAAE,CAAC,UAAU,CACnD;IACE,MAAM;IACN,aAAa,oHAAA,CAAA,yCAAsC;IACnD,cAAc,oHAAA,CAAA,0CAAuC;AACvD,GACA,OAAM;IACJ,MAAM,EAAC,MAAM,EAAC,GAAG,MAAM,kCAAkC;IACzD,OAAO;AACT;;;IA9BoB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 628, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/ai/flows/generate-city-plan.ts"],"sourcesContent":["'use server';\n\n/**\n * @fileOverview Generates a comprehensive city plan including a visual map layout.\n *\n * - generateCityPlan - A function that takes terrain analysis and city parameters\n *                        to generate a full city plan with map data.\n */\n\nimport { ai } from '@/ai/genkit';\nimport { GenerateCityPlanInputSchema, GenerateCityPlanOutputSchema, type GenerateCityPlanInput, type GenerateCityPlanOutput } from '@/ai/schemas';\n\nexport async function generateCityPlan(input: GenerateCityPlanInput): Promise<GenerateCityPlanOutput> {\n  return generateCityPlanFlow(input);\n}\n\nconst prompt = ai.definePrompt({\n  name: 'generateCityPlanPrompt',\n  input: { schema: GenerateCityPlanInputSchema },\n  output: { schema: GenerateCityPlanOutputSchema },\n  prompt: `\n    Create a detailed city plan for a population of {{{population}}} with budget ₹{{{budget}}}.\n    The zone distribution is: {{{zoneDistribution}}}.\n    Special requirements: {{{specialRequirements}}}.\n    The terrain analysis is: {{{terrainAnalysis}}}.\n\n    Return ONLY pure JSON in this EXACT format, without any other text or markdown.\n    Ensure all zone polygons are closed (first and last coordinates are identical).\n\n    {\n      \"mapData\": {\n        \"roads\": [\n          {\"type\": \"highway\", \"coordinates\": [[10,20], [30,40], [50,60]], \"reason\": \"Explain why this route was chosen\"},\n          {\"type\": \"arterial\", \"coordinates\": [[15,25], [35,45]], \"reason\": \"Explain arterial road placement\"},\n          {\"type\": \"local\", \"coordinates\": [[30,10], [30,90]], \"reason\": \"Local road for residential access\"}\n        ],\n        \"zones\": [\n          {\"type\": \"residential\", \"coordinates\": [[0,0], [40,0], [40,40], [0,40], [0,0]], \"density\": \"medium\", \"reason\": \"Explain residential zone location.\"},\n          {\"type\": \"commercial\", \"coordinates\": [[40,0], [80,0], [80,40], [40,40], [40,0]], \"reason\": \"Explain commercial zone location.\"},\n          {\"type\": \"industrial\", \"coordinates\": [[0,40], [40,40], [40,80], [0,80], [0,40]], \"reason\": \"Explain industrial zone location.\"}\n        ],\n        \"infrastructure\": [\n          {\"type\": \"power_plant\", \"coordinates\": [70,70], \"capacity\": \"150MW\", \"reason\": \"Explain power plant location\"},\n          {\"type\": \"water_treatment\", \"coordinates\": [20,70], \"reason\": \"Explain water plant location\"},\n          {\"type\": \"hospital\", \"coordinates\": [50,20], \"reason\": \"Explain hospital location\"}\n        ]\n      },\n      \"report\": {\n        \"budgetBreakdown\": {\n          \"landAcquisition\": \"₹200 Cr\",\n          \"roadConstruction\": \"₹350 Cr\",\n          \"buildingConstruction\": \"₹300 Cr\",\n          \"utilities\": \"₹150 Cr\",\n          \"materials\": {\n            \"concrete\": \"75,000 cubic meters\",\n            \"steel\": \"15,000 tons\",\n            \"pipes\": \"200km\"\n          }\n        },\n        \"timeline\": {\n          \"phase1\": \"6 months - Land development and basic infrastructure.\",\n          \"phase2\": \"12 months - Road network and utilities.\",\n          \"phase3\": \"18 months - Building construction and finishing.\"\n        }\n      }\n    }\n    `,\n});\n\nconst generateCityPlanFlow = ai.defineFlow(\n  {\n    name: 'generateCityPlanFlow',\n    inputSchema: GenerateCityPlanInputSchema,\n    outputSchema: GenerateCityPlanOutputSchema,\n  },\n  async (input) => {\n    const { output, usage } = await prompt(input);\n    \n    // Instead of throwing an error, we just return the (potentially incomplete) output.\n    // The frontend action will handle validation.\n    if (!output) {\n      console.error('AI response was null or undefined.');\n      console.error('Token usage:', usage);\n    } else if (!output.mapData || !output.report) {\n      console.warn('AI response is missing mapData or report.', JSON.stringify(output, null, 2));\n    }\n\n    return output!;\n  }\n);\n"],"names":[],"mappings":";;;;;AAEA;;;;;CAKC,GAED;AACA;;;;;;AAEO,eAAe,iBAAiB,KAA4B;IACjE,OAAO,qBAAqB;AAC9B;AAEA,MAAM,SAAS,mHAAA,CAAA,KAAE,CAAC,YAAY,CAAC;IAC7B,MAAM;IACN,OAAO;QAAE,QAAQ,oHAAA,CAAA,8BAA2B;IAAC;IAC7C,QAAQ;QAAE,QAAQ,oHAAA,CAAA,+BAA4B;IAAC;IAC/C,QAAQ,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IA8CP,CAAC;AACL;AAEA,MAAM,uBAAuB,mHAAA,CAAA,KAAE,CAAC,UAAU,CACxC;IACE,MAAM;IACN,aAAa,oHAAA,CAAA,8BAA2B;IACxC,cAAc,oHAAA,CAAA,+BAA4B;AAC5C,GACA,OAAO;IACL,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,OAAO;IAEvC,oFAAoF;IACpF,8CAA8C;IAC9C,IAAI,CAAC,QAAQ;QACX,QAAQ,KAAK,CAAC;QACd,QAAQ,KAAK,CAAC,gBAAgB;IAChC,OAAO,IAAI,CAAC,OAAO,OAAO,IAAI,CAAC,OAAO,MAAM,EAAE;QAC5C,QAAQ,IAAI,CAAC,6CAA6C,KAAK,SAAS,CAAC,QAAQ,MAAM;IACzF;IAEA,OAAO;AACT;;;IA5EoB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 731, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/actions.ts"],"sourcesContent":["'use server';\n\nimport { summarizeTerrainAnalysis } from '@/ai/flows/summarize-terrain-analysis';\nimport { optimizeZoneDistribution } from '@/ai/flows/optimize-zone-distribution';\nimport { simulateTrafficAndPollution } from '@/ai/flows/simulate-traffic-and-pollution';\nimport { generateCityPlan } from '@/ai/flows/generate-city-plan';\nimport type { CityParams, FullReport, CityPlan, MapData } from '@/lib/types';\n\nexport async function analyzeImage(imageData: string): Promise<string> {\n  if (!imageData) {\n    throw new Error('Image data is required for analysis.');\n  }\n\n  // The provided Genkit flow requires a `terrainAnalysis` string.\n  // Since we cannot generate it from the image alone with the given flows,\n  // we will provide a mock, descriptive analysis to satisfy the flow's input schema.\n  const mockTerrainAnalysis =\n    'The satellite image displays a varied landscape. The area is predominantly flat with a gentle slope towards the south. A river meanders from the northwest to the southeast, suggesting ample water supply but also flood-prone zones. Patches of dense green indicate fertile soil, suitable for parks or agriculture. A rocky outcrop is visible in the northeast quadrant, which might be challenging for construction but could be a source of materials. There is no existing infrastructure visible.';\n\n  try {\n    const result = await summarizeTerrainAnalysis({\n      satelliteImageDataUri: imageData,\n      terrainAnalysis: mockTerrainAnalysis,\n    });\n    return result.summary;\n  } catch (error) {\n    console.error('Error in summarizeTerrainAnalysis flow:', error);\n    throw new Error('Failed to analyze terrain from image.');\n  }\n}\n\nexport async function getOptimizedZones(\n  terrainSummary: string,\n  population: number,\n  budget: number\n) {\n  try {\n    const result = await optimizeZoneDistribution({\n      terrainAnalysis: terrainSummary,\n      population,\n      budget,\n    });\n    return result;\n  } catch (error) {\n    console.error('Error in optimizeZoneDistribution flow:', error);\n    throw new Error('Failed to optimize zone distribution.');\n  }\n}\n\nexport async function generatePlanAndSimulate(\n  terrainSummary: string,\n  cityParams: CityParams\n): Promise<FullReport> {\n\n  try {\n    const planResult = await generateCityPlan({\n      terrainAnalysis: terrainSummary,\n      population: cityParams.population,\n      budget: cityParams.budget,\n      zoneDistribution: JSON.stringify(cityParams.zoneDistribution),\n      specialRequirements: JSON.stringify(cityParams.specialRequirements),\n    });\n\n    if (!planResult || !planResult.mapData || !planResult.report) {\n      console.error('Invalid planResult received from AI:', planResult);\n      throw new Error(\"AI failed to return a valid city plan. The response was incomplete or malformed. Please try again.\");\n    }\n\n    const cityPlan: CityPlan = planResult.report;\n    const mapData: MapData = planResult.mapData;\n\n    const simulation = await simulateTrafficAndPollution({\n      cityPlan: JSON.stringify({ ...cityPlan, parameters: cityParams }),\n    });\n\n    return { cityPlan, simulation, cityParams, mapData };\n  } catch (error) {\n     console.error('Error in plan generation or simulation flow:', error);\n     if (error instanceof Error) {\n        throw error; // Re-throw the specific error\n     }\n    throw new Error('An unexpected error occurred during plan generation.');\n  }\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AACA;;;;;;;;AAGO,eAAe,aAAa,SAAiB;IAClD,IAAI,CAAC,WAAW;QACd,MAAM,IAAI,MAAM;IAClB;IAEA,gEAAgE;IAChE,yEAAyE;IACzE,mFAAmF;IACnF,MAAM,sBACJ;IAEF,IAAI;QACF,MAAM,SAAS,MAAM,CAAA,GAAA,sJAAA,CAAA,2BAAwB,AAAD,EAAE;YAC5C,uBAAuB;YACvB,iBAAiB;QACnB;QACA,OAAO,OAAO,OAAO;IACvB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2CAA2C;QACzD,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,eAAe,kBACpB,cAAsB,EACtB,UAAkB,EAClB,MAAc;IAEd,IAAI;QACF,MAAM,SAAS,MAAM,CAAA,GAAA,sJAAA,CAAA,2BAAwB,AAAD,EAAE;YAC5C,iBAAiB;YACjB;YACA;QACF;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2CAA2C;QACzD,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,eAAe,wBACpB,cAAsB,EACtB,UAAsB;IAGtB,IAAI;QACF,MAAM,aAAa,MAAM,CAAA,GAAA,8IAAA,CAAA,mBAAgB,AAAD,EAAE;YACxC,iBAAiB;YACjB,YAAY,WAAW,UAAU;YACjC,QAAQ,WAAW,MAAM;YACzB,kBAAkB,KAAK,SAAS,CAAC,WAAW,gBAAgB;YAC5D,qBAAqB,KAAK,SAAS,CAAC,WAAW,mBAAmB;QACpE;QAEA,IAAI,CAAC,cAAc,CAAC,WAAW,OAAO,IAAI,CAAC,WAAW,MAAM,EAAE;YAC5D,QAAQ,KAAK,CAAC,wCAAwC;YACtD,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,WAAqB,WAAW,MAAM;QAC5C,MAAM,UAAmB,WAAW,OAAO;QAE3C,MAAM,aAAa,MAAM,CAAA,GAAA,6JAAA,CAAA,8BAA2B,AAAD,EAAE;YACnD,UAAU,KAAK,SAAS,CAAC;gBAAE,GAAG,QAAQ;gBAAE,YAAY;YAAW;QACjE;QAEA,OAAO;YAAE;YAAU;YAAY;YAAY;QAAQ;IACrD,EAAE,OAAO,OAAO;QACb,QAAQ,KAAK,CAAC,gDAAgD;QAC9D,IAAI,iBAAiB,OAAO;YACzB,MAAM,OAAO,8BAA8B;QAC9C;QACD,MAAM,IAAI,MAAM;IAClB;AACF;;;IA3EsB;IAuBA;IAkBA;;AAzCA,+OAAA;AAuBA,+OAAA;AAkBA,+OAAA","debugId":null}},
    {"offset": {"line": 831, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {generatePlanAndSimulate as '6024f73fca3b54d68f0d6be7504e1182ea0c7f7c66'} from 'ACTIONS_MODULE0'\nexport {analyzeImage as '40123629eac77195a93172518109388c0258fcd3ad'} from 'ACTIONS_MODULE0'\nexport {getOptimizedZones as '70f3da1b607048be9261b21d63616ef957286bbe93'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 889, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAoR,GACjT,kDACA","debugId":null}},
    {"offset": {"line": 903, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/page.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAgQ,GAC7R,8BACA","debugId":null}},
    {"offset": {"line": 917, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}